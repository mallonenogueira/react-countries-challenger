{"version":3,"sources":["theme-context.tsx","components/theme-switch/index.tsx","components/header/index.tsx","components/container/index.tsx","components/input-search/index.tsx","components/country-card/index.tsx","pages/home/use-debounce.tsx","pages/home/page.tsx","services/api.tsx","pages/home/use-countries.tsx","services/country/service.tsx","pages/home/index.tsx","pages/country/index.tsx","routes.tsx","App.tsx","index.tsx"],"names":["ThemeContext","createContext","theme","toggleDarkTheme","ThemeProvider","children","useState","setTheme","useCallback","currentState","value","useMemo","useEffect","document","body","classList","add","remove","Provider","ThemeSwitch","useContext","content","icon","text","onClick","className","Header","Container","InputSearch","placeholder","onChange","CountryCard","name","flag","population","region","capital","key","src","alt","toLocaleString","formatPopulation","createDebounce","timeout","wait","call","debounceCallback","forceWait","clearTimeout","setTimeout","clear","React","memo","countries","loading","setLoading","search","setSearch","makeSearch","debounce","ref","useRef","current","useDebounce","event","target","length","map","country","buildContent","api","url","options","fetch","method","response","json","data","ok","Promise","reject","service","INITIAL_STATE","undefined","location","history","state","setState","controllerRef","setCountries","abort","AbortController","signal","handleRequest","request","then","catch","findByName","findAll","useCountries","query","queryString","parse","handleSetSearch","queryParam","stringifyUrl","pathname","push","Country","Routes","basename","exact","path","component","Home","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.d56fa66e.chunk.js","sourcesContent":["import React, {\n  createContext,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\nimport withChildren from \"types/with-children\";\n\nexport const ThemeContext = createContext({\n  theme: \"light\",\n  toggleDarkTheme: () => {},\n});\n\nexport function ThemeProvider({ children }: withChildren) {\n  const [theme, setTheme] = useState({\n    theme: \"light\",\n  });\n\n  const toggleDarkTheme = useCallback(() => {\n    setTheme((currentState) => ({\n      theme: currentState.theme === \"dark\" ? \"light\" : \"dark\",\n    }));\n  }, []);\n\n  const value = useMemo(\n    () => ({\n      theme: theme.theme,\n      toggleDarkTheme,\n    }),\n    [theme.theme, toggleDarkTheme]\n  );\n\n  useEffect(() => {\n    if (theme.theme === \"dark\") {\n      document.body.classList.add(\"dark-mode\");\n      document.body.classList.remove(\"light-mode\");\n    } else {\n      document.body.classList.add(\"light-mode\");\n      document.body.classList.remove(\"dark-mode\");\n    }\n  }, [theme]);\n\n  return (\n    <ThemeContext.Provider value={value}>{children}</ThemeContext.Provider>\n  );\n}\n","import React, { useContext } from \"react\";\nimport { ThemeContext } from \"theme-context\";\n\nimport \"./style.scss\";\n\nexport default function ThemeSwitch() {\n  const { theme, toggleDarkTheme } = useContext(ThemeContext);\n\n  const content =\n    theme === \"light\"\n      ? { icon: \"far fa-moon\", text: \"Dark Mode\" }\n      : { icon: \"far fa-sun\", text: \"Light Mode\" };\n\n  return (\n    <button onClick={toggleDarkTheme} className=\"theme-switch\">\n      <i className={content.icon}></i>\n      {content.text}\n    </button>\n  );\n}\n","import React from \"react\";\nimport ThemeSwitch from \"components/theme-switch\";\n\nimport \"./style.scss\";\n\nexport default function Header() {\n  return (\n    <header className=\"header\">\n      <h1>Where in the world?</h1>\n\n      <ThemeSwitch />\n    </header>\n  );\n}\n","import React from \"react\";\nimport withChildren from \"types/with-children\";\n\nimport \"./style.scss\";\n\nexport default function Container({ children }: withChildren) {\n  return <div className=\"container\">{children}</div>;\n}\n","import React from \"react\";\n\nimport \"./style.scss\";\n\nexport default function InputSearch({\n  placeholder,\n  className,\n  value,\n  onChange,\n}: {\n  className?: string;\n  placeholder?: string;\n  value: string;\n  onChange: (event: React.ChangeEvent<HTMLInputElement>) => void;\n}) {\n  return (\n    <label className={`input-search ${className || \"\"}`}>\n      <i className=\"fas fa-search input-search__icon\"></i>\n      <input\n        placeholder={placeholder}\n        className=\"input-search__element\"\n        onChange={onChange}\n        value={value}\n      />\n    </label>\n  );\n}\n","import React from \"react\";\nimport Country from \"services/country/model\";\n\nimport \"./style.scss\";\n\nfunction formatPopulation(population: number) {\n  return population.toLocaleString();\n}\n\nexport default function CountryCard({\n  name,\n  flag,\n  population,\n  region,\n  capital,\n}: Country) {\n  return (\n    <div key={name} className=\"country-card\">\n      <div className=\"country-card__image\">\n        <img src={flag} alt={`${name} flag`} />\n      </div>\n\n      <div className=\"country-card__content\">\n        <h2 className=\"country-card__title\">{name}</h2>\n\n        <div>\n          <span className=\"country-card__label\">Population: </span>\n          <span className=\"country-card__value\">\n            {formatPopulation(population)}\n          </span>\n        </div>\n\n        <div>\n          <span className=\"country-card__label\">Region: </span>\n          <span className=\"country-card__value\">{region}</span>\n        </div>\n\n        <div>\n          <span className=\"country-card__label\">Capital: </span>\n          <span className=\"country-card__value\">{capital}</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useRef } from \"react\";\n\nexport function createDebounce(wait = 100) {\n  let timeout: NodeJS.Timeout;\n\n  const call = (\n    debounceCallback: (...arg: any[]) => any,\n    forceWait?: number\n  ) => {\n    clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      debounceCallback();\n    }, forceWait || wait);\n  };\n\n  return {\n    call,\n    clear: () => clearTimeout(timeout),\n    wait,\n  };\n}\n\nexport function useDebounce(wait: number) {\n  const ref = useRef(createDebounce(wait));\n\n  useEffect(() => {\n    if (wait !== ref.current.wait) {\n      ref.current.clear();\n      ref.current = createDebounce(wait);\n    }\n  }, [wait]);\n\n  return ref.current.call;\n}\n","import React, { useEffect } from \"react\";\nimport Header from \"components/header\";\nimport Container from \"components/container\";\nimport InputSearch from \"components/input-search\";\nimport CountryCard from \"components/country-card\";\nimport Country from \"services/country/model\";\n\nimport \"./style.scss\";\nimport { useDebounce } from \"./use-debounce\";\n\ninterface Props {\n  countries: Country[];\n  loading: boolean;\n  search: string;\n  setSearch: (search?: string) => void;\n  makeSearch: (search?: string) => void;\n  setLoading: (loading: boolean) => void;\n}\n\nfunction Home({\n  countries,\n  loading,\n  setLoading,\n  search,\n  setSearch,\n  makeSearch,\n}: Props) {\n  const debounce = useDebounce(300);\n\n  useEffect(() => {\n    setLoading(true);\n\n    if (search) {\n      debounce(() => makeSearch(search));\n      return;\n    }\n\n    debounce(() => makeSearch(search), 0);\n  }, [search, setLoading, makeSearch, debounce]);\n\n  return (\n    <div>\n      <Header />\n\n      <Container>\n        <InputSearch\n          placeholder=\"Search for a country...\"\n          className=\"home__input\"\n          value={search}\n          onChange={(event) => setSearch(event.target.value)}\n        />\n\n        {buildContent(loading, countries)}\n      </Container>\n    </div>\n  );\n}\n\nfunction buildContent(loading: boolean, countries: Country[]) {\n  if (loading) {\n    return <div className=\"home--loading\">Loading...</div>;\n  }\n\n  if (!countries.length) {\n    return (\n      <div className=\"home--not-found\">\n        <div>\n          No countries found <strong>:(</strong>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"home\">\n      {countries.map((country) => (\n        <CountryCard key={country.name} {...country} />\n      ))}\n    </div>\n  );\n}\n\nexport default React.memo(Home);\n","export const api = {\n  async get<T>(url: string, options?: RequestInit) {\n    const response = await fetch(url, {\n      ...options,\n      method: \"GET\",\n    });\n    const data = {\n      data: (await response.json()) as T,\n      response,\n    };\n\n    if (response.ok) {\n      return data;\n    } else {\n      return Promise.reject(data);\n    }\n  },\n};\n","import { useCallback, useRef, useState } from \"react\";\n\nimport Country from \"services/country/model\";\nimport CountryService from \"services/country/service\";\n\nconst service = new CountryService();\n\ninterface CountriesType {\n  countries: Country[];\n  loading: boolean;\n}\n\nconst INITIAL_STATE = {\n  countries: [],\n  loading: false,\n  search: undefined,\n};\n\nexport function useCountries() {\n  const [state, setState] = useState<CountriesType>(INITIAL_STATE);\n  const controllerRef = useRef<AbortController | null>(null);\n\n  const setLoading = useCallback((loading) => {\n    setState((data) => ({ ...data, loading }));\n  }, []);\n\n  const setCountries = useCallback((countries) => {\n    setState((data) => ({ ...data, loading: false, countries }));\n  }, []);\n\n  const makeSearch = useCallback(\n    (search?: string) => {\n      controllerRef.current?.abort();\n      controllerRef.current = new AbortController();\n      const options = {\n        signal: controllerRef.current.signal,\n      };\n\n      const handleRequest = (request: Promise<Country[]>) => {\n        request\n          .then(setCountries)\n          .then(() => (controllerRef.current = null))\n          .catch(() => setCountries([]));\n      };\n\n      setLoading(true);\n\n      if (search) {\n        handleRequest(service.findByName(search, options));\n      } else {\n        handleRequest(service.findAll(options));\n      }\n    },\n    [setCountries, setLoading]\n  );\n\n  return {\n    state,\n    makeSearch,\n    setLoading,\n  };\n}\n","import { api } from \"services/api\";\nimport Country from \"./model\";\n\ninterface Options {\n  signal?: AbortSignal;\n}\n\nexport default class CountryService {\n  async findAll(options?: Options) {\n    const { data } = await api.get<Country[]>(\n      \"https://restcountries.eu/rest/v2/all\",\n      options\n    );\n    return data;\n  }\n\n  async findByName(name: string, options?: Options) {\n    const { data } = await api.get<Country[]>(\n      `https://restcountries.eu/rest/v2/name/${name}`,\n      options\n    );\n    return data;\n  }\n}\n","import React, { useCallback, useMemo } from \"react\";\nimport { RouteComponentProps } from \"react-router\";\nimport queryString from \"query-string\";\n\nimport Home from \"pages/home/page\";\nimport { useCountries } from \"./use-countries\";\n\nexport default function Container({ location, history }: RouteComponentProps) {\n  const { state, setLoading, makeSearch } = useCountries();\n  const query = useMemo<{ search?: string }>(\n    () => queryString.parse(location.search),\n    [location.search]\n  );\n\n  const handleSetSearch = useCallback(\n    (search?: string) => {\n      const queryParam = search ? { search } : {};\n      const url = queryString.stringifyUrl({\n        url: location.pathname,\n        query: queryParam,\n      });\n      history.push(url);\n    },\n    [history, location.pathname]\n  );\n\n  return (\n    <Home\n      search={query.search || \"\"}\n      countries={state.countries}\n      loading={state.loading}\n      setLoading={setLoading}\n      setSearch={handleSetSearch}\n      makeSearch={makeSearch}\n    />\n  );\n}\n","import React from \"react\";\n\nexport default function Country() {\n  return <div>Country</div>;\n}\n","import React from \"react\";\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\n\nimport Home from \"pages/home\";\nimport Country from \"pages/country\";\n\nexport default function Routes() {\n  return (\n    <Router basename=\"/react-countries-challenger\">\n      <Switch>\n        <Route exact path=\"/\" component={Home} />\n        <Route exact path=\"/country\" component={Country} />\n      </Switch>\n    </Router>\n  );\n}\n","import React from \"react\";\nimport Routes from \"routes\";\nimport { ThemeProvider } from \"theme-context\";\n\nimport \"styles/base.scss\";\n\nfunction App() {\n  return (\n    <ThemeProvider>\n      <Routes />\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}